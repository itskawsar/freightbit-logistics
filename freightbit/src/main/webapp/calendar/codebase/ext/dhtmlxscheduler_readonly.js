scheduler.attachEvent("onTemplatesReady",function(){function e(e,t,i,l){for(var n=t.getElementsByTagName(e),s=i.getElementsByTagName(e),o=s.length-1;o>=0;o--){var i=s[o];if(l){var h=document.createElement("SPAN");h.className="dhx_text_disabled",h.innerHTML=l(n[o]),i.parentNode.insertBefore(h,i),i.parentNode.removeChild(i)}else i.disabled=!0,t.checked&&(i.checked=!0)}}var t=(scheduler.config.lightbox.sections,null),i=scheduler.config.buttons_left.slice(),l=scheduler.config.buttons_right.slice();scheduler.attachEvent("onBeforeLightbox",function(e){if(this.config.readonly_form||this.getEvent(e).readonly){this.config.readonly_active=!0;for(var n=0;n<this.config.lightbox.sections.length;n++)this.config.lightbox.sections[n].focus=!1}else this.config.readonly_active=!1,scheduler.config.buttons_left=i.slice(),scheduler.config.buttons_right=l.slice();var s=this.config.lightbox.sections;if(this.config.readonly_active){for(var o=!1,n=0;n<s.length;n++)if("recurring"==s[n].type){t=s[n],this.config.readonly_active&&s.splice(n,1);break}o||this.config.readonly_active||!t||s.splice(s.length-2,0,t);for(var h=["dhx_delete_btn","dhx_save_btn"],r=[scheduler.config.buttons_left,scheduler.config.buttons_right],n=0;n<h.length;n++)for(var c=h[n],a=0;a<r.length;a++){for(var d=r[a],g=-1,u=0;u<d.length;u++)if(d[u]==c){g=u;break}-1!=g&&d.splice(g,1)}}return this.resetLightbox(),!0});var n=scheduler._fill_lightbox;scheduler._fill_lightbox=function(){var t=this.getLightbox();this.config.readonly_active&&(t.style.visibility="hidden",t.style.display="block");var i=n.apply(this,arguments);if(this.config.readonly_active&&(t.style.visibility="",t.style.display="none"),this.config.readonly_active){var l=this.getLightbox(),o=this._lightbox_r=l.cloneNode(!0);o.id=scheduler.uid(),e("textarea",l,o,function(e){return e.value}),e("input",l,o,!1),e("select",l,o,function(e){return e.options.length?e.options[Math.max(e.selectedIndex||0,0)].text:""}),l.parentNode.insertBefore(o,l),s.call(this,o),scheduler._lightbox&&scheduler._lightbox.parentNode.removeChild(scheduler._lightbox),this._lightbox=o,scheduler.config.drag_lightbox&&(o.firstChild.onmousedown=scheduler._ready_to_dnd),this.setLightboxSize(),o.onclick=function(e){var t=e?e.target:event.srcElement;if(t.className||(t=t.previousSibling),t&&t.className)switch(t.className){case"dhx_cancel_btn":scheduler.callEvent("onEventCancel",[scheduler._lightbox_id]),scheduler._edit_stop_event(scheduler.getEvent(scheduler._lightbox_id),!1),scheduler.hide_lightbox()}}}return i};var s=scheduler.showCover;scheduler.showCover=function(){this.config.readonly_active||s.apply(this,arguments)};var o=scheduler.hide_lightbox;scheduler.hide_lightbox=function(){return this._lightbox_r&&(this._lightbox_r.parentNode.removeChild(this._lightbox_r),this._lightbox_r=this._lightbox=null),o.apply(this,arguments)}});